import{r as t,x as g,j as s,L as p}from"./index-B0XDuo0H.js";import{b as w,d as j,s as v}from"./teleconsultation_admin-D-KquQ7Q.js";import{F as y}from"./PaperAirplaneIcon-DhZLkS3L.js";function N({title:r,titleId:l,...d},a){return t.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":l},d),r?t.createElement("title",{id:l},r):null,t.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const S=t.forwardRef(N);function M(){const{sessionId:r}=g(),[l,d]=t.useState([]),[a,f]=t.useState(""),[o,i]=t.useState(!1),[n,x]=t.useState(!1),c=t.useRef(null),u=t.useRef(null);t.useEffect(()=>{if(!r)return;const e=w(r,d),h=j(r,b=>{b==="closed"?(x(!0),i(!0)):(x(!1),i(!1))});return()=>{e(),h()}},[r]),t.useEffect(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)},[l]),t.useEffect(()=>{if(!u.current)return;const e=u.current;e.style.height="auto",e.style.height=`${Math.min(e.scrollHeight,96)}px`},[a]);const m=async()=>{if(!(!a.trim()||!r||n)){i(!0);try{await v(r,a),f("")}catch(e){console.error("Send failed:",e)}finally{i(!1)}}};return s.jsxs("div",{className:"flex flex-col h-full p-6",children:[s.jsx("div",{className:"flex items-center mb-4",children:s.jsxs(p,{to:"/admin-teleconsultation",className:"flex items-center text-[#0F8A69] hover:underline font-medium",children:[s.jsx(S,{className:"w-5 h-5 mr-2"}),"Back"]})}),s.jsx("h1",{className:"text-xl font-semibold text-[#0F8A69] mb-6",children:"Teleconsultation â€“ Chat"}),n&&s.jsx("div",{className:"mb-4 p-3 rounded bg-red-100 text-red-700 font-medium",children:"Session Closed"}),s.jsxs("div",{className:"flex flex-col flex-1 min-h-0",children:[s.jsx("div",{ref:c,className:"flex-1 bg-white rounded-xl shadow-md p-6 space-y-4 overflow-y-auto",children:l.map(e=>s.jsx("div",{children:s.jsx("div",{className:`flex ${e.sender==="doctor"||e.sender==="bot"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`p-4 rounded-xl max-w-xs break-words whitespace-pre-wrap ${e.sender==="doctor"?"bg-blue-600 text-white":e.sender==="user"?"bg-[#0F8A69] text-white":"bg-gray-200 text-gray-700"}`,children:e.text})})},e.id))}),s.jsxs("div",{className:"relative flex items-center space-x-3 pt-4 shrink-0",children:[s.jsx("textarea",{ref:u,placeholder:n?"Cannot send messages (session closed)":"Write a message",value:a,onChange:e=>f(e.target.value),onKeyDown:e=>{e.key==="Enter"&&!e.shiftKey&&!o&&a.trim()&&!n&&(e.preventDefault(),m())},rows:1,style:{resize:"none",overflow:"auto",maxHeight:"6rem"},className:"flex-1 border rounded-lg p-3 outline-none focus:ring-2 focus:ring-[#0F8A69]",disabled:o||n}),s.jsx("button",{onClick:m,disabled:o||!a.trim()||n,className:`bg-blue-600 p-3 rounded-lg text-white ${o||!a.trim()||n?"opacity-50 cursor-not-allowed":"hover:bg-blue-700"}`,children:s.jsx(y,{className:"w-6 h-6 rotate-45"})})]})]})]})}export{M as default};
